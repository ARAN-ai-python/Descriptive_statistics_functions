# n_way_ANOVA
## 概要
以前からインターンにてクラスカル=ウォリス検定を用いた分析を行ったり、一元配置分散分析をdescribes関数に実装する等、分散分析自体は勉強して知っていました。  
この度実験計画法を勉強する内に二元配置以上の分散分析にも興味が湧き、プログラミングにて自動化することを考えました。  
(自分の調べた限りだと)二元配置以上の分散分析には使いやすいライブラリがなく、describes関数と棲み分けられる内容である事も自作を後押しする要因となりました。

## リファレンス
一応読めば使える様に善処したが、分からなければそれぞれの関数のファイルに記述されているテストケースを見て真似ることで使用できると思われる。

### 一元配置分散分析
- 因子が１つの時に用いる。
- データの母集団が正規分布に従うことを仮定する。
- 水準毎にサンプルサイズが異なっていても構わない。
- 有意差があった場合は「その因子に効果がある」事が言える。(どの水準に効果があるかは分からない)
  - 帰無仮説：各水準の平均値が等しい
  - 対立仮説：各水準の平均値が異なる

#### 使い方
<img width="332" alt="スクリーンショット 2022-02-09 0 33 11" src="https://user-images.githubusercontent.com/67265109/153020945-8a176d7e-7e39-4358-a71d-7ce29ee00b5a.png">
<img width="116" alt="image" src="https://user-images.githubusercontent.com/67265109/153023595-59bf3ac6-e97e-45e0-8255-d5cc80390182.png">

1. 因子Bをカラムに設定し、それぞれの水準毎に一列ずつデータを入れたデータフレームを作成する。(上記の例では、それぞれb0,b1,b2が水準である。)
2. 分散分析表と効果表を代入する変数を用意し、作成したデータフレームをそのまま引数に入れ、関数を実行する。
3. 返り値である分散分析表から分析結果を読み取る。(signカラムは有意水準1%で有意である因子に「**」、有意水準5%で有意である因子に「*」で印をつけている。)
4. 分散分析の結果に応じて、効果表から読み取った各水準の効果を活用する。


### 二元配置分散分析(繰返し無)
- 因子が２つの時に用いる。
- データの母集団が正規分布に従うことを仮定する。
- 有意差があった場合は「その因子に効果がある」事が言える。(どの水準に効果があるかは分からない)
  - 帰無仮説：各水準の平均値が等しい
  - 対立仮説：各水準の平均値が異なる

#### 使い方
<img width="285" alt="スクリーンショット 2022-02-09 0 33 31" src="https://user-images.githubusercontent.com/67265109/153021230-5355d0e9-2cb2-46b3-ae10-45bb3ba6b84d.png">

1. 因子Aをインデックスに、因子Bをカラムに設定し、それぞれの水準毎に一つずつデータを入れたデータフレームを作成する。(上記の例では、因子Aの水準がa0,a1、因子Bの水準がb0,b1,b2である。)
2. 分散分析表と効果表を代入する変数を用意し、作成したデータフレームをそのまま引数に入れ、関数を実行する。
3. 返り値である分散分析表から分析結果を読み取る。(signカラムは有意水準1%で有意である因子に「**」、有意水準5%で有意である因子に「*」で印をつけている。)
4. 分散分析の結果に応じて、効果表から読み取った各水準の効果を活用する。


### 二元配置分散分析(繰返し有)
- 因子が２つの時かつ２因子の交互作用を考慮する際に用いる。
- データの母集団が正規分布に従うことを仮定する。
- 有意差があった場合は「その因子に効果がある」事が言える。(どの水準に効果があるかは分からない)
  - 帰無仮説：各水準の平均値が等しい
  - 対立仮説：各水準の平均値が異なる

#### 使い方
<img width="390" alt="スクリーンショット 2022-02-09 0 33 47" src="https://user-images.githubusercontent.com/67265109/153022672-008bdc8f-ca45-4592-8643-38ab32a26230.png">

1. 因子Aをインデックスに、因子Bをカラムに設定し、それぞれの水準毎に一つずつデータを入れたデータフレームを作成する。(上記の例では、因子Aの水準がa0,a1、因子Bの水準がb0,b1,b2である。)
2. 1.で行った前処理を、繰返しの数だけ行う。(上記の例では、繰返し数が２回なので２個のデータフレームを作成している。)
3. 分散分析表と効果表を代入する変数を用意し、作成したデータフレームをリストとしてまとめて引数に入れ、関数を実行する。
4. 返り値である分散分析表から分析結果を読み取る。(signカラムは有意水準1%で有意である因子に「**」、有意水準5%で有意である因子に「*」で印をつけている。)
5. 分散分析の結果に応じて、効果表から読み取った各水準の効果を活用する。


### 三元配置分散分析(繰返し無)
- 因子が３つの時に用いる。
- データの母集団が正規分布に従うことを仮定する。
- 有意差があった場合は「その因子に効果がある」事が言える。(どの水準に効果があるかは分からない)
  - 帰無仮説：各水準の平均値が等しい
  - 対立仮説：各水準の平均値が異なる

#### 使い方
<img width="116" alt="スクリーンショット 2022-02-09 0 34 39" src="https://user-images.githubusercontent.com/67265109/153023504-62e481fb-17ab-43fe-bf55-8d0f97d1fdf5.png">
<img width="453" alt="スクリーンショット 2022-02-09 0 34 51" src="https://user-images.githubusercontent.com/67265109/153023531-0c0b0977-7e9f-4ffb-aa0c-24895e822ad7.png">

1. 因子Aをインデックスに、因子Bをカラムに、因子Cをテーブルとして設定し、それぞれの水準毎に一つずつデータを入れたデータフレームを作成する。(上記の例では、因子Aの水準がa0,a1、因子Bの水準がb0,b1,b2、因子Cの水準がデータフレーム１(上),データフレーム2(下)である。)
2. 分散分析表と効果表を代入する変数を用意し、作成したデータフレームをリストとしてまとめて引数に入れ、関数を実行する。
3. 返り値である分散分析表から分析結果を読み取る。(signカラムは有意水準1%で有意である因子に「**」、有意水準5%で有意である因子に「*」で印をつけている。)
4. 分散分析の結果に応じて、効果表から読み取った各水準の効果を活用する。(テーブルとして分けた因子Cの効果は0,1等の数値のカラム名となっている。)

### 三元配置分散分析(繰返し有)
- 因子が３つの時かつ３因子の交互作用を考慮する際に用いる。
- データの母集団が正規分布に従うことを仮定する。
- 有意差があった場合は「その因子に効果がある」事が言える。(どの水準に効果があるかは分からない)
  - 帰無仮説：各水準の平均値が等しい
  - 対立仮説：各水準の平均値が異なる

#### 使い方
<img width="119" alt="スクリーンショット 2022-02-09 0 35 55" src="https://user-images.githubusercontent.com/67265109/153025136-b4bd84db-f17a-4eed-b573-73a28cec2388.png">
<img width="116" alt="スクリーンショット 2022-02-09 0 36 06" src="https://user-images.githubusercontent.com/67265109/153025144-337a55fa-b1b0-4d05-969c-58d808db14ef.png">
<img width="508" alt="スクリーンショット 2022-02-09 0 36 16" src="https://user-images.githubusercontent.com/67265109/153025165-bb3e7699-9b13-4213-bf78-61eb0402b246.png">

1. 因子Aをインデックスに、因子Bをカラムに、因子Cをテーブルとして設定し、それぞれの水準毎に一つずつデータを入れたデータフレームを作成する。(上記の例では、因子Aの水準がa0,a1、因子Bの水準がb0,b1,b2、因子Cの水準がデータフレーム１(上),データフレーム2(下)である。)
2. 1.で行った前処理を、繰返しの数だけ行う。(上記の例では、繰返し数が２回なので４個のデータフレームを作成している。)
3. 分散分析表と効果表を代入する変数を用意し、作成したデータフレームを繰返し毎に分けて二重リストとしてまとめて引数に入れ、関数を実行する。
4. 返り値である分散分析表から分析結果を読み取る。(signカラムは有意水準1%で有意である因子に「**」、有意水準5%で有意である因子に「*」で印をつけている。)
5. 分散分析の結果に応じて、効果表から読み取った各水準の効果を活用する。(テーブルとして分けた因子Cの効果は0,1等の数値のカラム名となっている。)
